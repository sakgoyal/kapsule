import C from"lodash-es/debounce";var h=class{name;defaultVal;triggerUpdate;onChange;constructor(o,{default:s=null,triggerUpdate:c=!0,onChange:d=(m,g)=>{}}){this.name=o,this.defaultVal=s,this.triggerUpdate=c,this.onChange=d}};function V({stateInit:i=()=>({}),props:o={},methods:s={},aliases:c={},init:d=()=>{},update:m=()=>{}}){let g=Object.keys(o).map(r=>new h(r,o[r]));return function(r={}){let n={...i instanceof Function?i(r):i,initialised:!1},l={};function t(e){return K(e,r),f(),t}function K(e,a){d.call(t,e,n,a),n.initialised=!0}let f=C(()=>{n.initialised&&(m.call(t,n,l),l={})},1);g.forEach(e=>{t[e.name]=a(e);function a({name:p,triggerUpdate:O=!1,onChange:P=(y,u)=>{},defaultVal:x=null}){return function(y){let u=n[p];if(!arguments.length)return u;let S=y===void 0?x:y;return n[p]=S,P.call(t,S,n,u),!l.hasOwnProperty(p)&&(l[p]=u),O&&f(),t}}});for(let e in s)t[e]=(...a)=>s[e].call(t,n,...a);for(let[e,a]of Object.entries(c))t[e]=t[a];return t.resetProps=function(){return g.forEach(e=>{t[e.name](e.defaultVal)}),t},t.resetProps(),n._rerender=f,t}}export{V as Kapsule};
